<!DOCTYPE html>
<ui:composition template="/WEB-INF/template/layout.xhtml"
		xmlns="http://www.w3.org/1999/xhtml"
		xmlns:ui="http://java.sun.com/jsf/facelets"
		xmlns:f="http://java.sun.com/jsf/core"
		xmlns:h="http://java.sun.com/jsf/html"
		xmlns:p="http://primefaces.org/ui"
		xmlns:stella="http://stella.caelum.com.br/faces2">
		
	<ui:define name="titulo">Gerar Orçamentos</ui:define>
	
	
	<ui:define name="corpo">
	
      <div class="jumbotron" style="margin-top: 15px;">
      			
      			
      		<h:form prependId="false">
      		
		       	<div class="row">
		       		<h3> <i class="fa fa-building fa-1x"></i> Informe o Nome do Anúncio </h3>
		       		<p:separator />
		       		<p:spacer />
		       		
		       			<div class="form-group">
							<p:inputText styleClass="form-control input-lg" placeholder="informe o nome..." required="true" id="nomePesquisa" value="#{orcamentoMB.nomePesquisa}"/>
		       			</div>
						
						<div class="form-group">
							<h:commandButton value="Pesquisar" styleClass="btn btn-lg btn-primary btn-block" actionListener="#{orcamentoMB.pesquisarAnuncios}">
								<f:ajax render=":form:anunciosList nomePesquisa" execute="@form"/>
							</h:commandButton>
						</div>
		       	</div>
      		</h:form>
		       	
		       	<p:separator />
		       	<p:spacer />	      
      
      		
      		<h:form id="form">
			    <p:dataGrid var="anuncio" value="#{orcamentoMB.anunciosByPesquisa}" columns="3" layout="grid" rows="12" paginator="true" id="anunciosList"
			        paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
			        rowsPerPageTemplate="6,12,18">
			 
			        <f:facet name="header">
			            Listagem Anuncios
			        </f:facet>
			        
			 
			        <p:panel header="##{anuncio.id} - #{anuncio.empresa.nomeFantasia}" style="text-align: center;">
			            <h:panelGrid columns="1" style="width:100%" id="selectedAnuncio">
			            
							<p:graphicImage value="#{imagemMB.anuncioImagem}" width="100%" height="140" styleClass="img-retangle" rendered="#{not empty anuncio.imagem}">
				        		<f:param name="idAnuncio" value="#{anuncio.id}"/>
				        	</p:graphicImage>
				        	
				        	<p:graphicImage width="100%" height="140" name="imagens/imagem-nao-disponivel.jpg" rendered="#{empty anuncio.imagem}" />
				        	
				        	<p:spacer />
				        	
			        	      <div class="alert alert-info">
						        <strong> #{anuncio.nome} </strong>
						      </div>
				        	
			                <p:commandButton update=":form:anuncioDialog" oncomplete="PF('anuncioDialog').show()" title="Detalhes Anuncio" value="Visualizar Anuncio" styleClass="btn btn-sm" >
			                    <f:setPropertyActionListener value="#{anuncio}" target="#{orcamentoMB.anuncioSelected}" />
			                </p:commandButton>

							<p:spacer />
				        	
				        	<h:commandButton styleClass="btn btn-sm btn-primary" value="Adicionar" actionListener="#{orcamentoMB.adicionarAnuncio}">
				        		<f:ajax render=":formMenu:labelCountAnuncios" execute="@form"/>
				        		<f:param name="idAnuncio" value="#{anuncio.id}"/>
				        	</h:commandButton> 	
				        		
			                
			            </h:panelGrid>
			        </p:panel>
			 
			    </p:dataGrid>
			    
			 
			    <p:dialog header="Detalhes Anuncio" widgetVar="anuncioDialog" modal="true" height="350px" resizable="false">
			        <p:outputPanel id="anuncioDialog" style="text-align:center;">
			            <p:panelGrid  columns="2" rendered="#{not empty orcamentoMB.anuncioSelected}">
				        			            
			                <f:facet name="header">
								<p:graphicImage value="#{imagemMB.anuncioImagem}" width="100%" height="100%" rendered="#{not empty orcamentoMB.anuncioSelected.imagem}">
					        		<f:param name="idAnuncio" value="#{orcamentoMB.anuncioSelected.id}"/>
					        	</p:graphicImage>
					        	<p:graphicImage width="100%" height="100%" name="imagens/imagem-nao-disponivel.jpg" rendered="#{empty orcamentoMB.anuncioSelected.imagem}" />
			                </f:facet>
			 
			                <h:outputText value="Id:" />
			                <h:outputText value="#{orcamentoMB.anuncioSelected.id}" />
			 
			                <h:outputText value="Nome" />
			                <h:outputText value="#{orcamentoMB.anuncioSelected.nome}" />
			 
			                <h:outputText value="Descrição:" />
			                <h:outputText value="#{orcamentoMB.anuncioSelected.descricao}" />
			 
			                <h:outputText value="Valor" />
				        	<h:outputText value="#{orcamentoMB.anuncioSelected.valor}" id="valorAnuncio" style="font-weight: bold; color: red;"> 
				            	<f:convertNumber locale="pt_BR" maxFractionDigits="2" minFractionDigits="2" />
				            </h:outputText>		                
			                
			            </p:panelGrid>
			        </p:outputPanel>
			    </p:dialog>   
			       		
      		</h:form>
      
        
      </div>
		
	</ui:define>		


</ui:composition>